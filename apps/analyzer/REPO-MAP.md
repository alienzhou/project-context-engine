# Repo Map: æ™ºèƒ½ä»£ç ä»“åº“åœ°å›¾ç”Ÿæˆå™¨

`Repo Map` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œæ—¨åœ¨ä¸ºä»£ç ä»“åº“ç”Ÿæˆä¸€ä¸ªç®€æ´ã€æ™ºèƒ½çš„"åœ°å›¾"ã€‚å®ƒèƒ½æå–å‡ºé¡¹ç›®ä¸­æœ€é‡è¦çš„ç±»ã€å‡½æ•°å’Œæ¥å£ç­‰ç¬¦å·ï¼Œå¹¶ä»¥æ¸…æ™°çš„ç»“æ„å±•ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå¸®åŠ©å¼€å‘è€…å’ŒAIå¿«é€Ÿç†è§£ä»£ç åº“çš„æ ¸å¿ƒç»“æ„ã€‚

å…¶è®¾è®¡çµæ„Ÿæ¥æºäº [aider.chat](https://aider.chat/docs/repomap.html) çš„ç†å¿µï¼Œå¹¶é€šè¿‡æ›´å…ˆè¿›çš„åˆ†æå’Œæ ¼å¼åŒ–åŠŸèƒ½è¿›è¡Œäº†å¢å¼ºã€‚

## æ ¸å¿ƒç‰¹æ€§

- ğŸ§  **æ™ºèƒ½åˆ†æ**ï¼šä½¿ç”¨ Tree-sitter ç²¾ç¡®è§£æä»£ç ï¼Œæå–è¶…è¿‡14ç§ä¸åŒç±»å‹çš„ç¬¦å·ï¼ˆç±»ã€å‡½æ•°ã€æšä¸¾ã€æ¥å£ç­‰ï¼‰ã€‚
- ğŸ“Š **é‡è¦æ€§æ’åº**ï¼šç»“åˆ PageRank ç®—æ³•å’Œå¤šç§å¯å‘å¼è§„åˆ™ï¼Œæ™ºèƒ½è¯„ä¼°æ–‡ä»¶å’Œç¬¦å·çš„é‡è¦æ€§ï¼Œä¼˜å…ˆå±•ç¤ºæ ¸å¿ƒä»£ç ã€‚
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**ï¼šå…¨é¢æ”¯æŒ JavaScript, TypeScript, Python, Java, Go, C++, React ç­‰å¤šç§ä¸»æµç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ã€‚
- ğŸ¯ **è¯­è¨€è¿‡æ»¤**ï¼šæ”¯æŒæŒ‡å®šç‰¹å®šè¯­è¨€è¿›è¡Œåˆ†æï¼Œæé«˜å¤§å‹å¤šè¯­è¨€é¡¹ç›®çš„åˆ†ææ•ˆç‡å’Œç²¾åº¦ã€‚
- ğŸ¯ **Token æ§åˆ¶**ï¼šæ™ºèƒ½æ§åˆ¶è¾“å‡ºå†…å®¹çš„é•¿åº¦ï¼Œç¡®ä¿å…¶èƒ½è½»æ¾é€‚é…å„ç±»å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ä¸Šä¸‹æ–‡çª—å£ã€‚
- ğŸ¨ **å¯è§†åŒ–è¾“å‡º**ï¼šä½¿ç”¨å›¾æ ‡ï¼ˆå¦‚ ğŸ›ï¸, âš¡, ğŸ”§ï¼‰å’Œä¿®é¥°ç¬¦ï¼ˆå¦‚ `[export]`, `[async]`ï¼‰å¢å¼ºè¾“å‡ºçš„å¯è¯»æ€§ã€‚
- âš™ï¸ **çµæ´»é…ç½®**ï¼šæä¾›ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œå¯è‡ªå®šä¹‰è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦å’Œæ ¼å¼ã€‚
- ğŸ–¥ï¸ **å‘½ä»¤è¡Œä¸API**ï¼šæ”¯æŒé€šè¿‡å‘½ä»¤è¡Œï¼ˆCLIï¼‰å’Œç¨‹åºåŒ–æ¥å£ï¼ˆAPIï¼‰ä¸¤ç§æ–¹å¼ä½¿ç”¨ï¼Œæ–¹ä¾¿é›†æˆåˆ°å„ç§å·¥ä½œæµä¸­ã€‚

## æ”¯æŒçš„è¯­è¨€

| è¯­è¨€                  | æ‰©å±•å                           | æ”¯æŒçŠ¶æ€    |
| :-------------------- | :------------------------------- | :---------- |
| JavaScript/TypeScript | .js, .ts, .jsx, .tsx, .mjs, .cjs | âœ… å®Œå…¨æ”¯æŒ |
| Java                  | .java                            | âœ… å®Œå…¨æ”¯æŒ |
| Kotlin                | .kt, .kts                        | âœ… å®Œå…¨æ”¯æŒ |
| Go                    | .go                              | âœ… å®Œå…¨æ”¯æŒ |
| C/C++                 | .c, .cpp, .h, .hpp, .cc, .cxx    | âœ… å®Œå…¨æ”¯æŒ |
| Python                | .py, .pyw                        | âœ… å®Œå…¨æ”¯æŒ |
| React                 | .jsx, .tsx                       | âœ… å®Œå…¨æ”¯æŒ |
| Rust                  | .rs                              | âœ… å®Œå…¨æ”¯æŒ |
| Swift                 | .swift                           | âœ… å®Œå…¨æ”¯æŒ |
| C#                    | .cs                              | âœ… å®Œå…¨æ”¯æŒ |
| Shell                 | .sh, .bash                       | âœ… åŸºæœ¬æ”¯æŒ |
| é…ç½®                  | .json, .yaml                     | âœ… åŸºæœ¬æ”¯æŒ |

## å¿«é€Ÿä¸Šæ‰‹

### 1. å®‰è£…ä¸æ„å»º

é¦–å…ˆï¼Œè¯·ç¡®ä¿æ‚¨å·²å®‰è£… `pnpm`ã€‚

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•å®‰è£…ä¾èµ–
pnpm install

# æ„å»ºé¡¹ç›®
pnpm build
```

### 2. ä½¿ç”¨æ–¹æ³•

#### å‘½ä»¤è¡Œ (CLI)

ä½ å¯ä»¥é€šè¿‡ CLI å¿«é€Ÿä¸ºä»»ä½•é¡¹ç›®ç”Ÿæˆ Repo Mapã€‚

##### åŸºæœ¬ç”¨æ³•

```bash
# åŸºæœ¬ç”¨æ³•ï¼šä¸ºæŒ‡å®šç›®å½•ç”Ÿæˆ repo mapï¼Œå¹¶æ‰“å°åˆ°æ§åˆ¶å°
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo>

# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
node apps/analyzer/dist/code-analyzer/repomap/cli.js --help
```

##### æ–°åŠŸèƒ½ï¼šè¯­è¨€è¿‡æ»¤ ğŸ¯

ç°åœ¨æ”¯æŒæŒ‡å®šç‰¹å®šè¯­è¨€è¿›è¡Œåˆ†æï¼Œå¤§å¤§æé«˜äº†å¤§å‹å¤šè¯­è¨€é¡¹ç›®çš„åˆ†ææ•ˆç‡ï¼š

```bash
# åªåˆ†æ Python æ–‡ä»¶
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> --language python

# åªåˆ†æ TypeScript æ–‡ä»¶ï¼ˆä½¿ç”¨ç®€å†™å‚æ•°ï¼‰
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> -l typescript

# åªåˆ†æ Java æ–‡ä»¶å¹¶ä¿å­˜åˆ°æ–‡ä»¶
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> -l java -o java-map.md

# åˆ†æ Go æ–‡ä»¶ï¼Œè®¾ç½®æ›´å¤§çš„ token é™åˆ¶ï¼Œè¾“å‡º JSON æ ¼å¼
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> -l go -t 4096 -f json
```

##### æ”¯æŒçš„è¯­è¨€å‚æ•°

```
javascript, typescript, python, java, kotlin, cpp, c, go, rust, swift,
scala, csharp, ruby, php, lua, bash, html, css, vue, json, yaml, xml
```

##### å®Œæ•´å‚æ•°åˆ—è¡¨

```bash
# å®Œæ•´çš„å‚æ•°æ ¼å¼
node apps/analyzer/dist/code-analyzer/repomap/cli.js <input-dir> [é€‰é¡¹]

é€‰é¡¹:
  -l, --language <lang>     æŒ‡å®šè¦åˆ†æçš„è¯­è¨€ (å¯é€‰)
  -o, --output <file>       è¾“å‡ºæ–‡ä»¶è·¯å¾„ (å¯é€‰)
  -t, --max-tokens <num>    æœ€å¤§ token æ•°é‡ (é»˜è®¤: 1024)
  -f, --format <format>     è¾“å‡ºæ ¼å¼: text | json (é»˜è®¤: text)
  -h, --help                æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

##### ä¼ ç»Ÿç”¨æ³•ï¼ˆå‘åå…¼å®¹ï¼‰

```bash
# ä¿å­˜åˆ°æ–‡ä»¶
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> repomap.md

# æ§åˆ¶ token æ•°é‡
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> repomap.md 2048

# ç”Ÿæˆ JSON æ ¼å¼è¾“å‡º
node apps/analyzer/dist/code-analyzer/repomap/cli.js <path/to/your/repo> repomap.json 4096 json
```

#### ç¨‹åºåŒ–æ¥å£ (API)

å°† Repo Map åŠŸèƒ½é›†æˆåˆ°ä½ è‡ªå·±çš„å·¥å…·æˆ–æœåŠ¡ä¸­ä¹Ÿéå¸¸ç®€å•ã€‚

```typescript
import { generateRepoMap } from './apps/analyzer/src/code-analyzer/repomap';
// æ³¨æ„ï¼šè¯·æ ¹æ®ä½ çš„é¡¹ç›®ç»“æ„è°ƒæ•´å¯¼å…¥è·¯å¾„

async function main() {
  // åŸºæœ¬ç”¨æ³•
  const result = await generateRepoMap('./path/to/your/repo', {
    maxTokens: 2048,
  });

  console.log(result.map);

  // ä½¿ç”¨è¯­è¨€è¿‡æ»¤ - åªåˆ†æ Python æ–‡ä»¶
  const pythonResult = await generateRepoMap('./path/to/your/repo', {
    maxTokens: 2048,
    language: 'python',
  });

  console.log('Python æ–‡ä»¶åˆ†æç»“æœ:');
  console.log(pythonResult.map);

  // ä¹Ÿå¯ä»¥è®¿é—®è¯¦ç»†çš„ç»“æ„åŒ–æ•°æ®
  // console.log(JSON.stringify(result.files, null, 2));
}

main();
```

## è¾“å‡ºç¤ºä¾‹ (æ–‡æœ¬æ ¼å¼)

ä»¥ä¸‹æ˜¯åŸºäº `test-multilang` ç›®å½•ç”Ÿæˆçš„ Repo Map ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å…¶ä¸°å¯Œçš„å¯è§†åŒ–è¾“å‡ºï¼š

### å®Œæ•´é¡¹ç›®åˆ†æ (æ‰€æœ‰è¯­è¨€)

```
react/UserCard.tsx:
â‹®...
â”‚âš¡ function useUserActions(user: User, onEdit?: (user: User) => void, onDelete?: (userId: number) => void)
 { } [L26-38]
â‹®...
â”‚âš¡ StatusBadge: React.FC< { } [L41-55]

javascript/user.js:
â‹®...
â”‚ğŸ›ï¸ class User { { } [L17-112]
    â”‚  âš¡ fromJSON(data) { } [L34-43]
    â”‚  âš¡ hasRole(role) { } [L68-70]
    â”‚  âš¡ userRole(role) { } [L101-107]
    â”‚  âš¡ createGuest() { } [L28-32]
    â”‚  âš¡ isValidEmail() { } [L45-47]
    â”‚  âš¡ getDisplayName() { } [L49-51]
    â”‚  âš¡ activate() { } [L53-56]
    â”‚  âš¡ deactivate() { } [L58-61]
â‹®...
â”‚âš¡ function createUser(userData) { } [L115-126]
â‹®...
â”‚âš¡ function loadUserData(userId) { } [L179-195]

javascript/userService.js:
â‹®...
â”‚ğŸ›ï¸ class UserService { { } [export] [L28-301]
    â”‚  âš¡ exportData() { } [export] [L247-254]
    â”‚  âš¡ _log(message, data = null) { } [L46-50]
    â”‚  âš¡ update(id, updates) { } [L147-172]
    â”‚  âš¡ _validateUser(user) { } [L52-56]
    â”‚  âš¡ create(userData) { } [L58-93]
    â”‚  âš¡ findById(id) { } [L95-104]
    â”‚  âš¡ findAll(filter = { } [L106-145]
    â”‚  âš¡ delete(id) { } [L174-196]
â‹®...
â”‚ğŸ›ï¸ class EventEmitter { { } [L4-26]
    â”‚  âš¡ on(event, listener) { } [L9-14]
    â”‚  âš¡ emit(event, ...args) { } [L16-20]
    â”‚  âš¡ off(event, listenerToRemove) { } [L22-25]
â‹®...
â”‚âš¡ function withRetry(fn, maxRetries = 3, delay = 1000) { } [L319-336]

typescript/UserService.ts:
â‹®...
â”‚ğŸ›ï¸ class UserService { { } [L28-138]
    â”‚  âš¡ findById(id: number) { } [L38-48]
    â”‚  âš¡ save(user: User) { } [L51-67]
    â”‚  âš¡ delete(id: number) { } [L70-76]
    â”‚  âš¡ findByFilter(filter: UserFilter) { } [L82-100]
    â”‚  âš¡ bulkCreate(userData: Partial<IUser>[]) { } [L106-124]
â‹®...
â”‚âš¡ function withRetry(
  fn: T,
  maxRetries: number = 3
) { } [L152-171]
```

### è¯­è¨€è¿‡æ»¤ç¤ºä¾‹

#### Python ä¸“é¡¹åˆ†æ (`--language python`)

```
python/utils.py:
â‹®...
â”‚ğŸ›ï¸ class ConfigManager: { } [L124-182]
â‹®...
â”‚ğŸ”§ def parse_config_file(file_path: str) -> Dict: { } [L45-61]
â‹®...
â”‚ğŸ”§ batch_process(items: List, batch_size: int = 100, 
                 processor: Callable = None) { } [L64-76]

python/user_service.py:
â‹®...
â”‚ğŸ›ï¸ class UserService: { } [L21-103]
â‹®...
â”‚âš¡ğŸ”„ async def async_process_users(users: List[User]) -> Dict[str, int]: { } [async] [L114-129]
â‹®...
â”‚ğŸ”§ def initialize_service(db_config: Dict[str, Any]) -> UserService: { } [L107-111]

python/user.py:
â‹®...
â”‚ğŸ›ï¸ class User: { } [static] [L8-45]
â‹®...
â”‚ğŸ”§ def get_users_by_status(users: List[User], is_active: bool = True) -> List[User]: { } [L57-59]
â‹®...
â”‚ğŸ”§ def create_admin_user(username: str) -> User: { } [L48-54]
```

#### TypeScript ä¸“é¡¹åˆ†æ (`--language typescript`)

```
react/UserCard.tsx:
â‹®...
â”‚âš¡ function useUserActions(user: User, onEdit?: (user: User) => void, onDelete?: (userId: number) => void)
 { } [L26-38]
â‹®...
â”‚âš¡ StatusBadge: React.FC< { } [L41-55]

typescript/UserService.ts:
â‹®...
â”‚ğŸ›ï¸ class UserService { { } [L28-138]
    â”‚  âš¡ findById(id: number) { } [L38-48]
    â”‚  âš¡ save(user: User) { } [L51-67]
    â”‚  âš¡ delete(id: number) { } [L70-76]
    â”‚  âš¡ findByFilter(filter: UserFilter) { } [L82-100]
    â”‚  âš¡ bulkCreate(userData: Partial<IUser>[]) { } [L106-124]
    â”‚  âš¡ findAll() { } [L78-80]
    â”‚  âš¡ count() { } [L102-104]
    â”‚  âš¡ clearCache() { } [L126-128]
â‹®...
â”‚âš¡ function withRetry(
  fn: T,
  maxRetries: number = 3
) { } [L152-171]
â‹®...
â”‚âš¡ function createUserService(options?: Partial<UserServiceConfig>) { } [L141-149]

typescript/User.ts:
â‹®...
â”‚ğŸ›ï¸ class User { { } [L26-70]
    â”‚  âš¡ createGuest() { } [L41-43]
    â”‚  âš¡ isValidEmail() { } [L45-47]
    â”‚  âš¡ getDisplayName() { } [L49-51]
    â”‚  âš¡ activate() { } [L53-55]
    â”‚  âš¡ deactivate() { } [L57-59]
    â”‚  âš¡ toJSON() { } [L61-69]
â‹®...
â”‚âš¡ function createUserFromData(data: Partial<IUser>) { } [L84-94]
```

### ç¬¦å·å›¾æ ‡å«ä¹‰

- ğŸ›ï¸ **ç±»/æ¥å£** - æ ¸å¿ƒä¸šåŠ¡å¯¹è±¡
- âš¡ **å‡½æ•°/æ–¹æ³•** - åŠŸèƒ½å®ç°
- ğŸ—ï¸ **æ„é€ å‡½æ•°** - å¯¹è±¡åˆå§‹åŒ–
- ğŸ”§ **å·¥å…·å‡½æ•°** - è¾…åŠ©åŠŸèƒ½
- ğŸ“‹ **ç±»å‹å®šä¹‰** - æ•°æ®ç»“æ„
- ğŸ·ï¸ **æ ‡ç­¾/æšä¸¾** - å¸¸é‡å®šä¹‰
- ğŸ“¦ **æ¨¡æ¿å…ƒç´ ** - UI ç»„ä»¶
- ğŸ”„ **å¼‚æ­¥å‡½æ•°** - å¼‚æ­¥æ“ä½œ
- `[export]` - å¯¼å‡ºç¬¦å·
- `[static]` - é™æ€æˆå‘˜
- `[async]` - å¼‚æ­¥æ ‡è®°
- `[L26-38]` - è¡Œå·èŒƒå›´

## é…ç½®é€‰é¡¹

ä½ å¯ä»¥é€šè¿‡ `RepoMapOptions` å¯¹è±¡è‡ªå®šä¹‰ç”Ÿæˆè¿‡ç¨‹ã€‚

```typescript
interface RepoMapOptions {
  maxTokens?: number; // æœ€å¤§tokenæ•°ï¼Œé»˜è®¤1024
  includeTypes?: boolean; // æ˜¯å¦åŒ…å«ç±»å‹å®šä¹‰ï¼Œé»˜è®¤true
  includeVariables?: boolean; // æ˜¯å¦åŒ…å«å˜é‡ï¼Œé»˜è®¤false
  minImportance?: number; // æ˜¾ç¤ºç¬¦å·çš„æœ€å°é‡è¦æ€§é˜ˆå€¼ï¼Œé»˜è®¤0.5
  language?: string; // ğŸ†• æŒ‡å®šè¦åˆ†æçš„è¯­è¨€ï¼Œä¸æŒ‡å®šåˆ™åˆ†ææ‰€æœ‰æ”¯æŒçš„è¯­è¨€
  rootPath: string; // è¦åˆ†æçš„ä»“åº“æ ¹ç›®å½•è·¯å¾„
}
```

### è¯­è¨€è¿‡æ»¤é…ç½®è¯¦è§£

`language` å‚æ•°æ”¯æŒä»¥ä¸‹å€¼ï¼š

| è¯­è¨€       | å‚æ•°å€¼       | æ”¯æŒçš„æ–‡ä»¶æ‰©å±•å                                    |
| ---------- | ------------ | --------------------------------------------------- |
| JavaScript | `javascript` | `.js`, `.mjs`, `.cjs`, `.jsx`                       |
| TypeScript | `typescript` | `.ts`, `.tsx`                                       |
| Python     | `python`     | `.py`, `.pyw`                                       |
| Java       | `java`       | `.java`                                             |
| Kotlin     | `kotlin`     | `.kt`, `.kts`                                       |
| C++        | `cpp`        | `.cpp`, `.cc`, `.cxx`, `.c++`, `.h`, `.hpp`, `.hxx` |
| C          | `c`          | `.c`, `.h`                                          |
| Go         | `go`         | `.go`                                               |
| Rust       | `rust`       | `.rs`                                               |
| Swift      | `swift`      | `.swift`                                            |
| Scala      | `scala`      | `.scala`                                            |
| C#         | `csharp`     | `.cs`                                               |
| Ruby       | `ruby`       | `.rb`                                               |
| PHP        | `php`        | `.php`                                              |
| Lua        | `lua`        | `.lua`                                              |
| Bash       | `bash`       | `.sh`, `.bash`, `.zsh`                              |
| HTML       | `html`       | `.html`, `.htm`                                     |
| CSS        | `css`        | `.css`, `.scss`, `.sass`                            |
| Vue        | `vue`        | `.vue`                                              |
| JSON       | `json`       | `.json`                                             |
| YAML       | `yaml`       | `.yaml`, `.yml`                                     |
| XML        | `xml`        | `.xml`                                              |

## æœ€ä½³å®è·µ

### æ§åˆ¶è¾“å‡ºå¤§å°

- å¯¹äºå¤§å‹é¡¹ç›®ï¼Œé€‚å½“å¢åŠ  `maxTokens` ä»¥è·å–æ›´å®Œæ•´çš„è§†å›¾ã€‚
- å¯¹äºå¿«é€Ÿæ¦‚è§ˆæˆ–å°å‹é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨è¾ƒå°çš„ `maxTokens` (å¦‚ 512 æˆ– 1024)ã€‚

### è¯­è¨€è¿‡æ»¤ç­–ç•¥ ğŸ¯

- **å¤§å‹å¤šè¯­è¨€é¡¹ç›®**: ä½¿ç”¨ `--language` å‚æ•°ä¸“æ³¨äºç‰¹å®šæŠ€æœ¯æ ˆï¼Œé¿å…ä¿¡æ¯è¿‡è½½ã€‚
- **å¾®æœåŠ¡æ¶æ„**: ä¸ºæ¯ä¸ªæœåŠ¡çš„ä¸»è¦è¯­è¨€ç”Ÿæˆç‹¬ç«‹çš„ repo mapã€‚
- **ä»£ç å®¡æŸ¥**: åªåˆ†æå˜æ›´ç›¸å…³çš„è¯­è¨€ï¼Œæé«˜å®¡æŸ¥æ•ˆç‡ã€‚
- **æ–‡æ¡£ç”Ÿæˆ**: ä¸ºä¸åŒè¯­è¨€çš„å¼€å‘è€…ç”Ÿæˆä¸“é—¨çš„é¡¹ç›®åœ°å›¾ã€‚

### è¿‡æ»¤ç¬¦å·

- `minImportance`: æé«˜æ­¤é˜ˆå€¼å¯ä»¥è¿‡æ»¤æ‰ä¸é‚£ä¹ˆé‡è¦çš„ç¬¦å·ï¼Œåªå…³æ³¨æ ¸å¿ƒé€»è¾‘ã€‚
- `includeVariables`: å¦‚æœä½ å…³å¿ƒå¸¸é‡æˆ–å…¨å±€å˜é‡çš„å®šä¹‰ï¼Œå¯ä»¥å°†å…¶è®¾ä¸º `true`ã€‚

### é›†æˆåˆ° CI/CD

ä½ å¯ä»¥å°† Repo Map ç”Ÿæˆæ­¥éª¤æ·»åŠ åˆ°ä½ çš„ CI/CD æµç¨‹ä¸­ï¼Œä»¥ä¾¿æ¯æ¬¡ä»£ç å˜æ›´æ—¶è‡ªåŠ¨æ›´æ–°é¡¹ç›®çš„åœ°å›¾ã€‚

```yaml
# .github/workflows/repomap.yml
name: Generate Repo Map
on: [push]

jobs:
  repomap:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'pnpm'

      - name: Install dependencies
        run: pnpm install

      - name: Build
        run: pnpm build

      - name: Generate repo map
        run: |
          # ç”Ÿæˆå®Œæ•´çš„ repo map
          node apps/analyzer/dist/code-analyzer/repomap/cli.js . repomap.md 4096

          # ç”Ÿæˆç‰¹å®šè¯­è¨€çš„ repo map
          node apps/analyzer/dist/code-analyzer/repomap/cli.js . typescript-map.md 4096 text typescript
          node apps/analyzer/dist/code-analyzer/repomap/cli.js . python-map.md 4096 text python

      - name: Upload artifact
        uses: actions/upload-artifact@v3
        with:
          name: repomap
          path: |
            repomap.md
            typescript-map.md
            python-map.md
```

## å¸¸è§é—®é¢˜ (FAQ)

- **Q: ä¸ºä»€ä¹ˆæŸäº›å‡½æ•°æˆ–ç±»æ²¡æœ‰åœ¨åœ°å›¾ä¸­æ˜¾ç¤º?**
  A: Repo Map ä¼šåŸºäºé‡è¦æ€§å¯¹ç¬¦å·è¿›è¡Œæ’åºå’Œè¿‡æ»¤ã€‚å¦‚æœä¸€ä¸ªç¬¦å·æ²¡æœ‰è¢«å¯¼å‡ºï¼Œæ²¡æœ‰è¢«å…¶ä»–æ–‡ä»¶å¼•ç”¨ï¼Œä¸”æœ¬èº«ç±»å‹æƒé‡ä¸é«˜ï¼Œå®ƒå¯èƒ½è¢«è®¤ä¸ºæ˜¯æ¬¡è¦çš„è€Œä¸æ˜¾ç¤ºã€‚ä½ å¯ä»¥å°è¯•è°ƒä½ `minImportance` é˜ˆå€¼ã€‚

- **Q: è¾“å‡ºç»“æœä¸ºä»€ä¹ˆè¢«æˆªæ–­äº†?**
  A: è¿™æ˜¯ç”± `maxTokens` å‚æ•°æ§åˆ¶çš„ã€‚ä¸ºäº†ä¿è¯è¾“å‡ºçš„ç®€æ´æ€§ï¼Œå½“è¾¾åˆ° token é™åˆ¶æ—¶ä¼šåœæ­¢æ·»åŠ æ–°å†…å®¹ã€‚å¦‚æœéœ€è¦æ›´å®Œæ•´çš„åœ°å›¾ï¼Œè¯·å¢å¤§ `maxTokens` çš„å€¼æˆ–ä½¿ç”¨ `json` æ ¼å¼è¾“å‡ºã€‚

- **Q: æˆ‘å¯ä»¥æ·»åŠ å¯¹æ–°è¯­è¨€çš„æ”¯æŒå—?**
  A: å½“ç„¶å¯ä»¥ã€‚è¿™éœ€è¦æ›´æ–°å†…éƒ¨çš„è¯­è¨€æ˜ å°„é…ç½®ï¼Œå¹¶ç¡®ä¿ç›¸åº”çš„ Tree-sitter WASM è§£æå™¨å¯ç”¨ã€‚è¯¦æƒ…è¯·å‚è€ƒ[æŠ€æœ¯æŒ‡å—](./REPO-MAP-TECHNICAL.md)ã€‚

- **Q: è¯­è¨€è¿‡æ»¤åŠŸèƒ½å¦‚ä½•å·¥ä½œï¼Ÿ**
  A: å½“æŒ‡å®š `--language` å‚æ•°æ—¶ï¼Œå·¥å…·åªä¼šæ‰«æå’Œåˆ†æåŒ¹é…è¯¥è¯­è¨€çš„æ–‡ä»¶æ‰©å±•åã€‚ä¾‹å¦‚ï¼Œ`--language python` åªä¼šå¤„ç† `.py` å’Œ `.pyw` æ–‡ä»¶ã€‚è¿™å¤§å¤§æé«˜äº†å¤§å‹å¤šè¯­è¨€é¡¹ç›®çš„åˆ†ææ•ˆç‡ã€‚

- **Q: å¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªè¯­è¨€å—ï¼Ÿ**
  A: ç›®å‰ç‰ˆæœ¬ä¸æ”¯æŒåŒæ—¶æŒ‡å®šå¤šä¸ªè¯­è¨€ã€‚å¦‚æœéœ€è¦åˆ†æå¤šä¸ªè¯­è¨€ï¼Œå¯ä»¥åˆ†åˆ«è¿è¡Œå¤šæ¬¡å‘½ä»¤ï¼Œæˆ–è€…ä¸æŒ‡å®šè¯­è¨€å‚æ•°æ¥åˆ†ææ‰€æœ‰æ”¯æŒçš„è¯­è¨€ã€‚

---

æƒ³æ·±å…¥äº†è§£å®ç°ç»†èŠ‚ï¼Ÿè¯·é˜…è¯»æˆ‘ä»¬çš„ [**æŠ€æœ¯æŒ‡å— (REPO-MAP-TECHNICAL.md)**](./REPO-MAP-TECHNICAL.md)ã€‚
